# 🏛️ 反向交易机器人架构总结

## 📋 系统概览
这是一个基于 Cloudflare 全栈的智能交易机器人平台，采用事件驱动架构，支持多策略并行执行。

## 🎯 核心设计哲学
1. **边界清晰**：前端展示、Worker 计算、数据库状态，各司其职
2. **状态外化**：Worker 无状态设计，可无限水平扩展  
3. **策略可插拔**：新策略只需实现接口，无需修改核心逻辑
4. **事件驱动**：Telegram 信号触发，单向数据流

## 🔄 数据流架构
```
Telegram Signal ──→ Worker Webhook ──→ Signal Parser ──→ Strategy Engine ──→ OKX API
                                               ↓
                                        D1 Database (状态持久化)
                                               ↓  
                                        Next.js Dashboard (监控展示)
```

## 📊 技术栈
- **前端**：Next.js 15 + React 19 + TypeScript + Tailwind
- **后端**：Cloudflare Workers + D1 Database 
- **交易所**：OKX API
- **部署**：Cloudflare Pages + Workers
- **监控**：Sentry + 自定义仪表板

## 🎪 策略架构
### 简单反向策略 (Simple Reverse)
- **原理**：单次反向开仓，固定止盈止损
- **适用**：波动较小的市场
- **风控**：最大并发持仓限制

### 海龟反向策略 (Turtle Reverse)  
- **原理**：分批建仓，动态止盈
- **适用**：趋势性较强的市场
- **风控**：序列超时自动平仓

## 🛡️ 风险控制
1. **仓位管理**：最大持仓数量限制
2. **时间控制**：持仓超时自动平仓
3. **紧急止损**：全局止损线保护
4. **控制权交接**：检测到平仓信号时主动平仓

## 📈 监控指标
- **实时 PnL**：每个策略实例的盈亏
- **持仓状态**：活跃/关闭持仓统计
- **信号统计**：信号接收和执行成功率
- **错误监控**：通过 Sentry 追踪异常