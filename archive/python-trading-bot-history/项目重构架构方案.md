# é¡¹ç›®é‡æ„æ¶æ„æ–¹æ¡ˆ

## ğŸ—ï¸ æ–°æ¶æ„è®¾è®¡ï¼šåˆ†ç¦»é¡¹ç›®ç”Ÿæ€ç³»ç»Ÿ

### æ¶æ„ç†å¿µ
> "åˆ†è€Œæ²»ä¹‹ï¼Œå„å¸å…¶èŒã€‚ç‹¬ç«‹è¿è¡Œï¼Œé£é™©éš”ç¦»ã€‚"

## ğŸ“ å®Œæ•´ç›®å½•ç»“æ„

```
reverse-trading-ecosystem/
â”œâ”€â”€ README.md                           # ç”Ÿæ€ç³»ç»Ÿæ€»è§ˆ
â”œâ”€â”€ deploy/                             # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ simple-bot.dockerfile
â”‚   â””â”€â”€ turtle-bot.dockerfile
â”‚
â”œâ”€â”€ core-lib/                           # ğŸ§  å…±äº«æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ setup.py                       # åº“å®‰è£…é…ç½®
â”‚   â”œâ”€â”€ core/                          # åŸºç¡€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ config.py                  # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ logger.py                  # æ—¥å¿—ç³»ç»Ÿ
â”‚   â”‚   â””â”€â”€ exceptions.py              # å¼‚å¸¸ä½“ç³»
â”‚   â”œâ”€â”€ signal_processor/              # ä¿¡å·å¤„ç†
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ signal_parser.py
â”‚   â”‚   â”œâ”€â”€ signal_validator.py
â”‚   â”‚   â”œâ”€â”€ telegram_listener.py
â”‚   â”‚   â””â”€â”€ signal_dispatcher.py
â”‚   â”œâ”€â”€ trading_engine/                # äº¤æ˜“å¼•æ“
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ exchange_client.py
â”‚   â”‚   â”œâ”€â”€ order_executor.py          # å¾…å®ç°
â”‚   â”‚   â”œâ”€â”€ price_monitor.py           # å¾…å®ç°
â”‚   â”‚   â””â”€â”€ balance_manager.py         # å¾…å®ç°
â”‚   â””â”€â”€ utils/                         # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ time_utils.py
â”‚       â”œâ”€â”€ math_utils.py
â”‚       â””â”€â”€ validation_utils.py
â”‚
â”œâ”€â”€ simple-reverse-bot/                 # ğŸ¤– é¡¹ç›®Aï¼šç®€å•åå‘æœºå™¨äºº
â”‚   â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
â”‚   â”œâ”€â”€ requirements.txt               # ä¾èµ–ç®¡ç†
â”‚   â”œâ”€â”€ config/                        # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ config.json                # ä¸»é…ç½®
â”‚   â”‚   â”œâ”€â”€ trading.json               # äº¤æ˜“é…ç½®
â”‚   â”‚   â””â”€â”€ risk.json                  # é£æ§é…ç½®
â”‚   â”œâ”€â”€ strategy/                      # ç­–ç•¥å®ç°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ simple_reverse_strategy.py # ç®€å•åå‘ç­–ç•¥
â”‚   â”‚   â””â”€â”€ risk_manager.py            # é£é™©ç®¡ç†
â”‚   â”œâ”€â”€ logs/                          # æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ data/                          # æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ tests/                         # æµ‹è¯•ç”¨ä¾‹
â”‚   â”‚   â”œâ”€â”€ test_strategy.py
â”‚   â”‚   â””â”€â”€ test_integration.py
â”‚   â”œâ”€â”€ main.py                        # å¯åŠ¨å…¥å£
â”‚   â””â”€â”€ monitor.py                     # ç›‘æ§è„šæœ¬
â”‚
â”œâ”€â”€ turtle-reverse-bot/                 # ğŸ¢ é¡¹ç›®Bï¼šæµ·é¾Ÿæ»šä»“æœºå™¨äºº
â”‚   â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
â”‚   â”œâ”€â”€ requirements.txt               # ä¾èµ–ç®¡ç†
â”‚   â”œâ”€â”€ config/                        # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ config.json                # ä¸»é…ç½®
â”‚   â”‚   â”œâ”€â”€ turtle_strategy.json       # æµ·é¾Ÿç­–ç•¥é…ç½®
â”‚   â”‚   â””â”€â”€ risk.json                  # é£æ§é…ç½®
â”‚   â”œâ”€â”€ strategy/                      # ç­–ç•¥å®ç°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ turtle_reverse_strategy.py # æµ·é¾Ÿåå‘ç­–ç•¥
â”‚   â”‚   â”œâ”€â”€ position_manager.py        # ä»“ä½ç®¡ç†
â”‚   â”‚   â””â”€â”€ profit_manager.py          # åˆ†å±‚æ­¢ç›ˆç®¡ç†
â”‚   â”œâ”€â”€ logs/                          # æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ data/                          # æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ tests/                         # æµ‹è¯•ç”¨ä¾‹
â”‚   â”‚   â”œâ”€â”€ test_turtle_strategy.py
â”‚   â”‚   â””â”€â”€ test_position_manager.py
â”‚   â”œâ”€â”€ main.py                        # å¯åŠ¨å…¥å£
â”‚   â””â”€â”€ monitor.py                     # ç›‘æ§è„šæœ¬
â”‚
â””â”€â”€ monitoring-dashboard/               # ğŸ“Š å¯é€‰ï¼šç»Ÿä¸€ç›‘æ§é¢æ¿
    â”œâ”€â”€ README.md
    â”œâ”€â”€ requirements.txt
    â”œâ”€â”€ web/                           # Webç•Œé¢
    â”‚   â”œâ”€â”€ static/
    â”‚   â”œâ”€â”€ templates/
    â”‚   â””â”€â”€ app.py
    â”œâ”€â”€ api/                           # APIæ¥å£
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ bot_monitor.py
    â”‚   â””â”€â”€ performance_api.py
    â””â”€â”€ config/
        â””â”€â”€ dashboard.json
```

## ğŸ”„ é‡æ„æ­¥éª¤

### ç¬¬ä¸€é˜¶æ®µï¼šæ ¸å¿ƒåº“æŠ½å–
1. **åˆ›å»º core-lib åŒ…**
   - ç§»åŠ¨ç°æœ‰çš„ core/ã€signal_processor/ã€trading_engine/ åˆ° core-lib
   - åˆ›å»º setup.py ä½¿å…¶å¯å®‰è£…
   - æ·»åŠ ç‰ˆæœ¬ç®¡ç†

2. **åº“ä¾èµ–ç®¡ç†**
   ```python
   # core-lib/setup.py
   setup(
       name="reverse-trading-core",
       version="1.0.0",
       packages=find_packages(),
       install_requires=[
           "ccxt>=4.1.87",
           "telethon>=1.32.1", 
           "nest-asyncio>=1.5.8",
           "pytz>=2023.3"
       ]
   )
   ```

### ç¬¬äºŒé˜¶æ®µï¼šç®€å•æœºå™¨äººé¡¹ç›®
1. **ç‹¬ç«‹é¡¹ç›®ç»“æ„**
   ```
   simple-reverse-bot/
   â”œâ”€â”€ main.py                 # ç²¾ç®€çš„å¯åŠ¨ç¨‹åº
   â”œâ”€â”€ strategy/               # åªåŒ…å«ç®€å•ç­–ç•¥
   â””â”€â”€ config/                 # ç‹¬ç«‹é…ç½®
   ```

2. **ä¾èµ–ç®¡ç†**
   ```txt
   # requirements.txt
   reverse-trading-core==1.0.0  # å¼•ç”¨æ ¸å¿ƒåº“
   ```

3. **ç‹¬ç«‹é…ç½®**
   ```json
   {
     "strategy": {
       "name": "SimpleReverse",
       "profit_target": 0.30,
       "max_position_size": 500,
       "enabled_quantities": [1, 2, 3, 4, 5, 6]
     },
     "risk": {
       "max_daily_loss": 0.05,
       "position_timeout_hours": 4,
       "emergency_stop_loss": 0.15
     }
   }
   ```

### ç¬¬ä¸‰é˜¶æ®µï¼šæµ·é¾Ÿæœºå™¨äººé¡¹ç›®
1. **ç‹¬ç«‹é¡¹ç›®ç»“æ„**
   ```
   turtle-reverse-bot/
   â”œâ”€â”€ main.py                 # ä¸“é—¨çš„å¯åŠ¨ç¨‹åº
   â”œâ”€â”€ strategy/               # å¤æ‚çš„æµ·é¾Ÿç­–ç•¥
   â””â”€â”€ config/                 # æµ·é¾Ÿä¸“ç”¨é…ç½®
   ```

2. **æµ·é¾Ÿç­–ç•¥é…ç½®**
   ```json
   {
     "turtle_strategy": {
       "position_sizes": {
         "1": 10, "2": 20, "3": 30, 
         "4": 40, "5": 50, "6": 60
       },
       "profit_thresholds": {
         "3": 0.50, "4": 0.30, "5": 0.30, "6": 0.30
       },
       "close_ratios": {
         "3": 0.50, "4": 0.80, "5": 0.90, "6": 0.90
       }
     }
   }
   ```

## ğŸ”§ å…³é”®å®ç°æ–‡ä»¶

### core-lib/setup.py
```python
from setuptools import setup, find_packages

setup(
    name="reverse-trading-core",
    version="1.0.0",
    description="åå‘è·Ÿå•æœºå™¨äººæ ¸å¿ƒåº“",
    packages=find_packages(),
    install_requires=[
        "ccxt>=4.1.87",
        "telethon>=1.32.1",
        "nest-asyncio>=1.5.8", 
        "pytz>=2023.3"
    ],
    python_requires=">=3.8"
)
```

### simple-reverse-bot/main.py
```python
import asyncio
from reverse_trading_core.core.config import init_config
from reverse_trading_core.signal_processor import TelegramListener
from strategy.simple_reverse_strategy import SimpleReverseStrategy

async def main():
    config = init_config("config/config.json")
    strategy = SimpleReverseStrategy(config)
    listener = TelegramListener()
    
    # è¿æ¥ä¿¡å·å¤„ç†
    listener.add_signal_handler(strategy.process_signal)
    
    # å¯åŠ¨ç³»ç»Ÿ
    await strategy.start()
    await listener.start_listening()

if __name__ == "__main__":
    asyncio.run(main())
```

### turtle-reverse-bot/main.py
```python
import asyncio
from reverse_trading_core.core.config import init_config
from reverse_trading_core.signal_processor import TelegramListener
from strategy.turtle_reverse_strategy import TurtleReverseStrategy

async def main():
    config = init_config("config/config.json")
    strategy = TurtleReverseStrategy(config)
    listener = TelegramListener()
    
    # è¿æ¥ä¿¡å·å¤„ç†
    listener.add_signal_handler(strategy.process_signal)
    
    # å¯åŠ¨ç³»ç»Ÿ
    await strategy.start()
    await listener.start_listening()

if __name__ == "__main__":
    asyncio.run(main())
```

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### Docker Compose éƒ¨ç½²
```yaml
# deploy/docker-compose.yml
version: '3.8'
services:
  simple-bot:
    build:
      context: ../simple-reverse-bot
      dockerfile: ../deploy/simple-bot.dockerfile
    environment:
      - BOT_TYPE=simple
    volumes:
      - ./logs/simple:/app/logs
      - ./data/simple:/app/data
    restart: unless-stopped
    
  turtle-bot:
    build:
      context: ../turtle-reverse-bot  
      dockerfile: ../deploy/turtle-bot.dockerfile
    environment:
      - BOT_TYPE=turtle
    volumes:
      - ./logs/turtle:/app/logs
      - ./data/turtle:/app/data
    restart: unless-stopped
```

## ğŸ¯ æ¶æ„ä¼˜åŠ¿

### 1. **é£é™©éš”ç¦»**
- ç‹¬ç«‹è¿›ç¨‹ï¼Œä¸€ä¸ªå´©æºƒä¸å½±å“å¦ä¸€ä¸ª
- ç‹¬ç«‹èµ„é‡‘æ± ï¼Œé¿å…ç­–ç•¥é—´èµ„é‡‘ç«äº‰
- ç‹¬ç«‹é…ç½®ï¼Œç­–ç•¥å‚æ•°äº’ä¸å¹²æ‰°

### 2. **ç®€åŒ–éƒ¨ç½²**
- æ¯ä¸ªé¡¹ç›®èŒè´£å•ä¸€ï¼Œéƒ¨ç½²ç®€å•
- å¯ä»¥é€‰æ‹©æ€§éƒ¨ç½²ï¼ˆåªè¿è¡Œå…¶ä¸­ä¸€ä¸ªï¼‰
- ç‹¬ç«‹æ‰©å±•ï¼Œä¸åŒç­–ç•¥å¯ä»¥éƒ¨ç½²åˆ°ä¸åŒæœåŠ¡å™¨

### 3. **ç»´æŠ¤æ€§å¼º**
- ä»£ç ç»“æ„æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤
- ç‹¬ç«‹æµ‹è¯•ï¼Œé—®é¢˜å®šä½å‡†ç¡®
- ç‰ˆæœ¬ç®¡ç†ç‹¬ç«‹ï¼Œå‡çº§é£é™©å¯æ§

### 4. **å¯æ‰©å±•æ€§**
- æ–°ç­–ç•¥å¯ä»¥ç‹¬ç«‹æˆé¡¹ç›®
- æ ¸å¿ƒåº“ç»Ÿä¸€ç»´æŠ¤å’Œå‡çº§
- ç›‘æ§ç³»ç»Ÿå¯é€‰æ‹©æ€§æ¥å…¥

---

**ä¸‹ä¸€æ­¥ï¼šå¼€å§‹åˆ›å»ºé‡æ„åçš„é¡¹ç›®ç»“æ„**